"use strict";
(self["webpackChunknextcloud"] = self["webpackChunknextcloud"] || []).push([["data_image_svg_xml_3csvg_20xmlns_27http_www_w3_org_2000_svg_27_20width_2724_27_20height_2724_-28884d"],{

/***/ "data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M15.4%2016.6L10.8%2012l4.6-4.6L14%206l-6%206%206%206%201.4-1.4z%27/%3e%3c/svg%3e":
/*!***********************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M15.4%2016.6L10.8%2012l4.6-4.6L14%206l-6%206%206%206%201.4-1.4z%27/%3e%3c/svg%3e ***!
  \***********************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M15.4%2016.6L10.8%2012l4.6-4.6L14%206l-6%206%206%206%201.4-1.4z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M18.4%207.4L17%206l-6%206%206%206%201.4-1.4-4.6-4.6%204.6-4.6m-6%200L11%206l-6%206%206%206%201.4-1.4L7.8%2012l4.6-4.6z%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M18.4%207.4L17%206l-6%206%206%206%201.4-1.4-4.6-4.6%204.6-4.6m-6%200L11%206l-6%206%206%206%201.4-1.4L7.8%2012l4.6-4.6z%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M18.4%207.4L17%206l-6%206%206%206%201.4-1.4-4.6-4.6%204.6-4.6m-6%200L11%206l-6%206%206%206%201.4-1.4L7.8%2012l4.6-4.6z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M5.6%207.4L7%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6m6%200L13%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6z%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M5.6%207.4L7%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6m6%200L13%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6z%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M5.6%207.4L7%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6m6%200L13%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M8.6%2016.6l4.6-4.6-4.6-4.6L10%206l6%206-6%206-1.4-1.4z%27/%3e%3c/svg%3e":
/*!***************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M8.6%2016.6l4.6-4.6-4.6-4.6L10%206l6%206-6%206-1.4-1.4z%27/%3e%3c/svg%3e ***!
  \***************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M8.6%2016.6l4.6-4.6-4.6-4.6L10%206l6%206-6%206-1.4-1.4z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "./node_modules/@nextcloud/dialogs/dist/chunks/FilePicker-DBGB1Rec.mjs":
/*!*****************************************************************************!*\
  !*** ./node_modules/@nextcloud/dialogs/dist/chunks/FilePicker-DBGB1Rec.mjs ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ ui)
/* harmony export */ });
/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! vue */ "./node_modules/vue/dist/vue.runtime.esm.js");
/* harmony import */ var _nextcloud_files__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @nextcloud/files */ "./node_modules/@nextcloud/files/dist/index.mjs");
/* harmony import */ var _nextcloud_l10n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @nextcloud/l10n */ "./node_modules/@nextcloud/l10n/dist/index.mjs");
/* harmony import */ var _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @nextcloud/vue */ "./node_modules/@nextcloud/vue/dist/index.mjs");
/* harmony import */ var _nextcloud_initial_state__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @nextcloud/initial-state */ "./node_modules/@nextcloud/initial-state/dist/index.es.mjs");
/* harmony import */ var _nextcloud_router__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @nextcloud/router */ "./node_modules/@nextcloud/router/dist/index.mjs");
/* harmony import */ var _vueuse_core__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @vueuse/core */ "./node_modules/@vueuse/shared/index.mjs");
/* harmony import */ var _nextcloud_axios__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @nextcloud/axios */ "./node_modules/@nextcloud/axios/dist/index.es.mjs");
/* harmony import */ var _toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./toast-WB-IZBJw.mjs */ "./node_modules/@nextcloud/dialogs/dist/chunks/toast-WB-IZBJw.mjs");
/* harmony import */ var _nextcloud_auth__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @nextcloud/auth */ "./node_modules/@nextcloud/auth/dist/index.mjs");
/* harmony import */ var vue_frag__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! vue-frag */ "./node_modules/vue-frag/dist/frag.esm.js");
/* harmony import */ var _mdi_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @mdi/js */ "./node_modules/@mdi/js/mdi.js");
/* harmony import */ var _nextcloud_event_bus__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @nextcloud/event-bus */ "./node_modules/@nextcloud/event-bus/dist/index.mjs");
/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! path */ "./node_modules/path/path.js");
/* provided dependency */ var console = __webpack_require__(/*! ./node_modules/console-browserify/index.js */ "./node_modules/console-browserify/index.js");














function b(r, e, i, t, n, s, o, f) {
  var l = typeof r == "function" ? r.options : r;
  e && (l.render = e, l.staticRenderFns = i, l._compiled = !0), t && (l.functional = !0), s && (l._scopeId = "data-v-" + s);
  var _;
  if (o ? (_ = function(c) {
    c = c || // cached call
    this.$vnode && this.$vnode.ssrContext || // stateful
    this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext, !c && typeof __VUE_SSR_CONTEXT__ < "u" && (c = __VUE_SSR_CONTEXT__), n && n.call(this, c), c && c._registeredComponents && c._registeredComponents.add(o);
  }, l._ssrRegister = _) : n && (_ = f ? function() {
    n.call(
      this,
      (l.functional ? this.parent : this).$root.$options.shadowRoot
    );
  } : n), _)
    if (l.functional) {
      l._injectStyles = _;
      var a = l.render;
      l.render = function(d, C) {
        return _.call(C), a(d, C);
      };
    } else {
      var k = l.beforeCreate;
      l.beforeCreate = k ? [].concat(k, _) : [_];
    }
  return {
    exports: r,
    options: l
  };
}
const Fe = {
  name: "FileIcon",
  emits: ["click"],
  props: {
    title: {
      type: String
    },
    fillColor: {
      type: String,
      default: "currentColor"
    },
    size: {
      type: Number,
      default: 24
    }
  }
};
var Se = function() {
  var e = this, i = e._self._c;
  return i("span", e._b({ staticClass: "material-design-icon file-icon", attrs: { "aria-hidden": e.title ? null : !0, "aria-label": e.title, role: "img" }, on: { click: function(t) {
    return e.$emit("click", t);
  } } }, "span", e.$attrs, !1), [i("svg", { staticClass: "material-design-icon__svg", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: "0 0 24 24" } }, [i("path", { attrs: { d: "M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z" } }, [e.title ? i("title", [e._v(e._s(e.title))]) : e._e()])])]);
}, $e = [], Ne = /* @__PURE__ */ b(
  Fe,
  Se,
  $e,
  !1,
  null,
  null,
  null,
  null
);
const W = Ne.exports, D = () => {
  const r = () => document.getElementById("isPublic")?.value === "1", e = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(!0);
  return (0,vue__WEBPACK_IMPORTED_MODULE_11__.onBeforeMount)(() => {
    e.value = r();
  }), {
    isPublic: e
  };
};
/**
 * @copyright Copyright (c) 2023 Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @author Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @license AGPL-3.0-or-later
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 */
const G = () => {
  const r = (0,_nextcloud_initial_state__WEBPACK_IMPORTED_MODULE_3__.loadState)("files", "config", null), e = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(r?.show_hidden ?? !0), i = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(r?.sort_favorites_first ?? !0), t = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(r?.crop_image_previews ?? !0), { isPublic: n } = D();
  return (0,vue__WEBPACK_IMPORTED_MODULE_11__.onMounted)(async () => {
    if (n.value)
      console.debug("Skip loading files settings - currently on public share");
    else
      try {
        const { data: s } = await _nextcloud_axios__WEBPACK_IMPORTED_MODULE_5__["default"].get((0,_nextcloud_router__WEBPACK_IMPORTED_MODULE_4__.generateUrl)("/apps/files/api/v1/configs"));
        e.value = s?.data?.show_hidden ?? !1, i.value = s?.data?.sort_favorites_first ?? !0, t.value = s?.data?.crop_image_previews ?? !0;
      } catch (s) {
        console.error("Could not load files settings", s), (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.k)((0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Could not load files settings"));
      }
  }), {
    showHiddenFiles: e,
    sortFavoritesFirst: i,
    cropImagePreviews: t
  };
}, xe = (r) => {
  const e = (a) => a === "asc" ? "ascending" : a === "desc" ? "descending" : "none", i = (0,_nextcloud_initial_state__WEBPACK_IMPORTED_MODULE_3__.loadState)("files", "viewConfigs", null), t = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)({
    sortBy: i?.files?.sorting_mode ?? "basename",
    order: e(i?.files?.sorting_direction ?? "asc")
  }), n = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)({
    sortBy: i?.recent?.sorting_mode ?? "basename",
    order: e(i?.recent?.sorting_direction ?? "asc")
  }), s = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)({
    sortBy: i?.favorites?.sorting_mode ?? "basename",
    order: e(i?.favorites?.sorting_direction ?? "asc")
  }), { isPublic: o } = D();
  (0,vue__WEBPACK_IMPORTED_MODULE_11__.onMounted)(async () => {
    if (o.value)
      console.debug("Skip loading files views - currently on public share");
    else
      try {
        const { data: a } = await _nextcloud_axios__WEBPACK_IMPORTED_MODULE_5__["default"].get((0,_nextcloud_router__WEBPACK_IMPORTED_MODULE_4__.generateUrl)("/apps/files/api/v1/views"));
        t.value = {
          sortBy: a?.data?.files?.sorting_mode ?? "basename",
          order: e(a?.data?.files?.sorting_direction)
        }, s.value = {
          sortBy: a?.data?.favorites?.sorting_mode ?? "basename",
          order: e(a?.data?.favorites?.sorting_direction)
        }, n.value = {
          sortBy: a?.data?.recent?.sorting_mode ?? "basename",
          order: e(a?.data?.recent?.sorting_direction)
        };
      } catch (a) {
        console.error("Could not load files views", a), (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.k)((0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Could not load files views"));
      }
  });
  const f = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => (0,_vueuse_core__WEBPACK_IMPORTED_MODULE_12__.toValue)(r || "files") === "files" ? t.value : (0,_vueuse_core__WEBPACK_IMPORTED_MODULE_12__.toValue)(r) === "recent" ? n.value : s.value), l = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => f.value.sortBy), _ = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => f.value.order);
  return {
    filesViewConfig: t,
    favoritesViewConfig: s,
    recentViewConfig: n,
    currentConfig: f,
    sortBy: l,
    order: _
  };
}, Be = {
  name: "MenuUpIcon",
  emits: ["click"],
  props: {
    title: {
      type: String
    },
    fillColor: {
      type: String,
      default: "currentColor"
    },
    size: {
      type: Number,
      default: 24
    }
  }
};
var Pe = function() {
  var e = this, i = e._self._c;
  return i("span", e._b({ staticClass: "material-design-icon menu-up-icon", attrs: { "aria-hidden": e.title ? null : !0, "aria-label": e.title, role: "img" }, on: { click: function(t) {
    return e.$emit("click", t);
  } } }, "span", e.$attrs, !1), [i("svg", { staticClass: "material-design-icon__svg", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: "0 0 24 24" } }, [i("path", { attrs: { d: "M7,15L12,10L17,15H7Z" } }, [e.title ? i("title", [e._v(e._s(e.title))]) : e._e()])])]);
}, ze = [], Le = /* @__PURE__ */ b(
  Be,
  Pe,
  ze,
  !1,
  null,
  null,
  null,
  null
);
const Ie = Le.exports, Ve = {
  name: "MenuDownIcon",
  emits: ["click"],
  props: {
    title: {
      type: String
    },
    fillColor: {
      type: String,
      default: "currentColor"
    },
    size: {
      type: Number,
      default: 24
    }
  }
};
var Re = function() {
  var e = this, i = e._self._c;
  return i("span", e._b({ staticClass: "material-design-icon menu-down-icon", attrs: { "aria-hidden": e.title ? null : !0, "aria-label": e.title, role: "img" }, on: { click: function(t) {
    return e.$emit("click", t);
  } } }, "span", e.$attrs, !1), [i("svg", { staticClass: "material-design-icon__svg", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: "0 0 24 24" } }, [i("path", { attrs: { d: "M7,10L12,15L17,10H7Z" } }, [e.title ? i("title", [e._v(e._s(e.title))]) : e._e()])])]);
}, De = [], He = /* @__PURE__ */ b(
  Ve,
  Re,
  De,
  !1,
  null,
  null,
  null,
  null
);
const Me = He.exports, j = {
  "file-picker__file-icon": "_file-picker__file-icon_1vgv4_5"
}, Ae = /* @__PURE__ */ (0,vue__WEBPACK_IMPORTED_MODULE_11__.defineComponent)({
  __name: "LoadingTableRow",
  props: {
    showCheckbox: { type: Boolean }
  },
  setup(r) {
    return { __sfc: !0, fileListIconStyles: j };
  }
});
var Te = function() {
  var e = this, i = e._self._c, t = e._self._setupProxy;
  return i("tr", { staticClass: "file-picker__row loading-row", attrs: { "aria-hidden": "true" } }, [e.showCheckbox ? i("td", { staticClass: "row-checkbox" }, [i("span")]) : e._e(), i("td", { staticClass: "row-name" }, [i("div", { staticClass: "row-wrapper" }, [i("span", { class: t.fileListIconStyles["file-picker__file-icon"] }), i("span")])]), e._m(0), e._m(1)]);
}, Ue = [function() {
  var r = this, e = r._self._c;
  return r._self._setupProxy, e("td", { staticClass: "row-size" }, [e("span")]);
}, function() {
  var r = this, e = r._self._c;
  return r._self._setupProxy, e("td", { staticClass: "row-modified" }, [e("span")]);
}], Ee = /* @__PURE__ */ b(
  Ae,
  Te,
  Ue,
  !1,
  null,
  "6aded0d9",
  null,
  null
);
const Oe = Ee.exports;
/**
 * @copyright Copyright (c) 2023 Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @author Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @license AGPL-3.0-or-later
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 */
function Ze(r, e = {}) {
  e = { size: 32, cropPreview: !1, mimeFallback: !0, ...e };
  try {
    const i = r.attributes?.previewUrl || (0,_nextcloud_router__WEBPACK_IMPORTED_MODULE_4__.generateUrl)("/core/preview?fileId={fileid}", {
      fileid: r.fileid
    });
    let t;
    try {
      t = new URL(i);
    } catch {
      t = new URL(i, window.location.origin);
    }
    return t.searchParams.set("x", `${e.size}`), t.searchParams.set("y", `${e.size}`), t.searchParams.set("mimeFallback", `${e.mimeFallback}`), t.searchParams.set("a", e.cropPreview === !0 ? "0" : "1"), t.searchParams.set("c", `${r.attributes.etag}`), t;
  } catch {
    return null;
  }
}
const We = {
  name: "FolderIcon",
  emits: ["click"],
  props: {
    title: {
      type: String
    },
    fillColor: {
      type: String,
      default: "currentColor"
    },
    size: {
      type: Number,
      default: 24
    }
  }
};
var Ge = function() {
  var e = this, i = e._self._c;
  return i("span", e._b({ staticClass: "material-design-icon folder-icon", attrs: { "aria-hidden": e.title ? null : !0, "aria-label": e.title, role: "img" }, on: { click: function(t) {
    return e.$emit("click", t);
  } } }, "span", e.$attrs, !1), [i("svg", { staticClass: "material-design-icon__svg", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: "0 0 24 24" } }, [i("path", { attrs: { d: "M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z" } }, [e.title ? i("title", [e._v(e._s(e.title))]) : e._e()])])]);
}, je = [], Ke = /* @__PURE__ */ b(
  We,
  Ge,
  je,
  !1,
  null,
  null,
  null,
  null
);
const K = Ke.exports, Xe = {
  name: "FilePreview"
}, qe = /* @__PURE__ */ (0,vue__WEBPACK_IMPORTED_MODULE_11__.defineComponent)({
  ...Xe,
  props: {
    node: null,
    cropImagePreviews: { type: Boolean }
  },
  setup(r) {
    const e = r, i = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(j), t = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => Ze(e.node, { cropPreview: e.cropImagePreviews })), n = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => e.node.type === _nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.FileType.File), s = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(!1);
    return (0,vue__WEBPACK_IMPORTED_MODULE_11__.watch)(t, () => {
      if (s.value = !1, t.value) {
        const o = document.createElement("img");
        o.src = t.value.href, o.onerror = () => o.remove(), o.onload = () => {
          s.value = !0, o.remove();
        }, document.body.appendChild(o);
      }
    }, { immediate: !0 }), { __sfc: !0, fileListIconStyles: i, props: e, previewURL: t, isFile: n, canLoadPreview: s, IconFile: W, IconFolder: K };
  }
});
var Je = function() {
  var e = this, i = e._self._c, t = e._self._setupProxy;
  return i("div", { class: t.fileListIconStyles["file-picker__file-icon"], style: t.canLoadPreview ? { backgroundImage: `url(${t.previewURL})` } : void 0 }, [t.canLoadPreview ? e._e() : [t.isFile ? i(t.IconFile, { attrs: { size: 20 } }) : i(t.IconFolder, { attrs: { size: 20 } })]], 2);
}, Qe = [], Ye = /* @__PURE__ */ b(
  qe,
  Je,
  Qe,
  !1,
  null,
  null,
  null,
  null
);
const et = Ye.exports, tt = /* @__PURE__ */ (0,vue__WEBPACK_IMPORTED_MODULE_11__.defineComponent)({
  __name: "FileListRow",
  props: {
    allowPickDirectory: { type: Boolean },
    selected: { type: Boolean },
    showCheckbox: { type: Boolean },
    canPick: { type: Boolean },
    node: null,
    cropImagePreviews: { type: Boolean }
  },
  emits: ["update:selected", "enter-directory"],
  setup(r, { emit: e }) {
    const i = r, t = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => i.node.attributes?.displayName || i.node.basename.slice(0, i.node.extension ? -i.node.extension.length : void 0)), n = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => i.node.extension), s = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => i.node.type === _nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.FileType.Folder), o = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => i.canPick && (i.allowPickDirectory || !s.value));
    function f() {
      e("update:selected", !i.selected);
    }
    function l() {
      s.value ? e("enter-directory", i.node) : f();
    }
    function _(a) {
      a.key === "Enter" && l();
    }
    return { __sfc: !0, props: i, emit: e, displayName: t, fileExtension: n, isDirectory: s, isPickable: o, toggleSelected: f, handleClick: l, handleKeyDown: _, formatFileSize: _nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.formatFileSize, NcCheckboxRadioSwitch: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcCheckboxRadioSwitch, NcDateTime: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcDateTime, t: _toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t, FilePreview: et };
  }
});
var it = function() {
  var e = this, i = e._self._c, t = e._self._setupProxy;
  return i("tr", e._g({ class: ["file-picker__row", {
    "file-picker__row--selected": e.selected && !e.showCheckbox
  }], attrs: { tabindex: e.showCheckbox && !t.isDirectory ? void 0 : 0, "aria-selected": t.isPickable ? e.selected : void 0, "data-filename": e.node.basename, "data-testid": "file-list-row" } }, {
    click: t.handleClick,
    /* same as tabindex -> if we hide the checkbox or this is a directory we need keyboard access to enter the directory or select the node */
    ...!e.showCheckbox || t.isDirectory ? { keydown: t.handleKeyDown } : {}
  }), [e.showCheckbox ? i("td", { staticClass: "row-checkbox", on: { click: function(n) {
    return n.stopPropagation(), (() => {
    }).apply(null, arguments);
  } } }, [i(t.NcCheckboxRadioSwitch, { attrs: { "aria-label": t.t("Select the row for {nodename}", { nodename: t.displayName }), checked: e.selected, disabled: !t.isPickable, "data-testid": "row-checkbox" }, on: { "update:checked": t.toggleSelected } })], 1) : e._e(), i("td", { staticClass: "row-name" }, [i("div", { staticClass: "file-picker__name-container", attrs: { "data-testid": "row-name" } }, [i(t.FilePreview, { attrs: { node: e.node, "crop-image-previews": e.cropImagePreviews } }), i("div", { staticClass: "file-picker__file-name", attrs: { title: t.displayName }, domProps: { textContent: e._s(t.displayName) } }), i("div", { staticClass: "file-picker__file-extension", domProps: { textContent: e._s(t.fileExtension) } })], 1)]), i("td", { staticClass: "row-size" }, [e._v(" " + e._s(t.formatFileSize(e.node.size || 0)) + " ")]), i("td", { staticClass: "row-modified" }, [i(t.NcDateTime, { attrs: { timestamp: e.node.mtime, "ignore-seconds": !0 } })], 1)]);
}, nt = [], st = /* @__PURE__ */ b(
  tt,
  it,
  nt,
  !1,
  null,
  "48df4f27",
  null,
  null
);
const rt = st.exports, lt = /* @__PURE__ */ (0,vue__WEBPACK_IMPORTED_MODULE_11__.defineComponent)({
  __name: "FileList",
  props: {
    currentView: null,
    multiselect: { type: Boolean },
    allowPickDirectory: { type: Boolean },
    loading: { type: Boolean },
    files: null,
    selectedFiles: null,
    path: null
  },
  emits: ["update:path", "update:selectedFiles"],
  setup(r, { emit: e }) {
    const i = r, t = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(), { currentConfig: n } = xe(i.currentView), s = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => t.value ?? n.value), o = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => s.value.sortBy === "basename" ? s.value.order === "none" ? void 0 : s.value.order : void 0), f = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => s.value.sortBy === "size" ? s.value.order === "none" ? void 0 : s.value.order : void 0), l = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => s.value.sortBy === "mtime" ? s.value.order === "none" ? void 0 : s.value.order : void 0), _ = (g) => {
      s.value.sortBy === g ? s.value.order === "ascending" ? t.value = { sortBy: s.value.sortBy, order: "descending" } : t.value = { sortBy: s.value.sortBy, order: "ascending" } : t.value = { sortBy: g, order: "ascending" };
    }, { sortFavoritesFirst: a, cropImagePreviews: k } = G(), c = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(
      () => {
        const g = {
          ascending: (h, m, B) => B(h, m),
          descending: (h, m, B) => B(m, h),
          // eslint-disable-next-line @typescript-eslint/no-unused-vars
          none: (h, m, B) => 0
        }, F = {
          basename: (h, m) => (h.attributes?.displayName || h.basename).localeCompare(m.attributes?.displayName || m.basename, (0,_nextcloud_l10n__WEBPACK_IMPORTED_MODULE_1__.getCanonicalLocale)()),
          size: (h, m) => (h.size || 0) - (m.size || 0),
          // reverted because "young" is smaller than "old"
          mtime: (h, m) => (m.mtime?.getTime?.() || 0) - (h.mtime?.getTime?.() || 0)
        };
        return [...i.files].sort(
          (h, m) => (
            // Folders always come above the files
            (m.type === _nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.FileType.Folder ? 1 : 0) - (h.type === _nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.FileType.Folder ? 1 : 0) || (a ? (m.attributes.favorite ? 1 : 0) - (h.attributes.favorite ? 1 : 0) : 0) || g[s.value.order](h, m, F[s.value.sortBy])
          )
        );
      }
    ), d = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => i.files.filter((g) => i.allowPickDirectory || g.type !== _nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.FileType.Folder)), C = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => !i.loading && i.selectedFiles.length > 0 && i.selectedFiles.length >= d.value.length);
    function L() {
      i.selectedFiles.length < d.value.length ? e("update:selectedFiles", d.value) : e("update:selectedFiles", []);
    }
    function N(g) {
      i.selectedFiles.includes(g) ? e("update:selectedFiles", i.selectedFiles.filter((F) => F.path !== g.path)) : i.multiselect ? e("update:selectedFiles", [...i.selectedFiles, g]) : e("update:selectedFiles", [g]);
    }
    function I(g) {
      e("update:path", g.path);
    }
    const x = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(4), S = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)();
    {
      const g = () => (0,vue__WEBPACK_IMPORTED_MODULE_11__.nextTick)(() => {
        const F = S.value?.parentElement?.children || [];
        let h = S.value?.parentElement?.clientHeight || 450;
        for (let m = 0; m < F.length; m++)
          S.value?.isSameNode(F[m]) || (h -= F[m].clientHeight);
        x.value = Math.floor((h - 50) / 50);
      });
      (0,vue__WEBPACK_IMPORTED_MODULE_11__.onMounted)(() => {
        window.addEventListener("resize", g), g();
      }), (0,vue__WEBPACK_IMPORTED_MODULE_11__.onUnmounted)(() => {
        window.removeEventListener("resize", g);
      });
    }
    return { __sfc: !0, props: i, emit: e, customSortingConfig: t, filesAppSorting: n, sortingConfig: s, sortByName: o, sortBySize: f, sortByModified: l, toggleSorting: _, sortFavoritesFirst: a, cropImagePreviews: k, sortedFiles: c, selectableFiles: d, allSelected: C, onSelectAll: L, onNodeSelected: N, onChangeDirectory: I, skeletonNumber: x, fileContainer: S, NcButton: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcButton, NcCheckboxRadioSwitch: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcCheckboxRadioSwitch, t: _toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t, IconSortAscending: Ie, IconSortDescending: Me, LoadingTableRow: Oe, FileListRow: rt };
  }
});
var at = function() {
  var e = this, i = e._self._c, t = e._self._setupProxy;
  return i("div", { ref: "fileContainer", staticClass: "file-picker__files" }, [i("table", [i("thead", [i("tr", [e.multiselect ? i("th", { staticClass: "row-checkbox" }, [i("span", { staticClass: "hidden-visually" }, [e._v(" " + e._s(t.t("Select entry")) + " ")]), e.multiselect ? i(t.NcCheckboxRadioSwitch, { attrs: { "aria-label": t.t("Select all entries"), checked: t.allSelected, "data-testid": "select-all-checkbox" }, on: { "update:checked": t.onSelectAll } }) : e._e()], 1) : e._e(), i("th", { staticClass: "row-name", attrs: { "aria-sort": t.sortByName } }, [i("div", { staticClass: "header-wrapper" }, [i("span", { staticClass: "file-picker__header-preview" }), i(t.NcButton, { attrs: { wide: !0, type: "tertiary", "data-test": "file-picker_sort-name" }, on: { click: function(n) {
    return t.toggleSorting("basename");
  } }, scopedSlots: e._u([{ key: "icon", fn: function() {
    return [t.sortByName === "ascending" ? i(t.IconSortAscending, { attrs: { size: 20 } }) : t.sortByName === "descending" ? i(t.IconSortDescending, { attrs: { size: 20 } }) : i("span", { staticStyle: { width: "44px" } })];
  }, proxy: !0 }]) }, [e._v(" " + e._s(t.t("Name")) + " ")])], 1)]), i("th", { staticClass: "row-size", attrs: { "aria-sort": t.sortBySize } }, [i(t.NcButton, { attrs: { wide: !0, type: "tertiary" }, on: { click: function(n) {
    return t.toggleSorting("size");
  } }, scopedSlots: e._u([{ key: "icon", fn: function() {
    return [t.sortBySize === "ascending" ? i(t.IconSortAscending, { attrs: { size: 20 } }) : t.sortBySize === "descending" ? i(t.IconSortDescending, { attrs: { size: 20 } }) : i("span", { staticStyle: { width: "44px" } })];
  }, proxy: !0 }]) }, [e._v(" " + e._s(t.t("Size")) + " ")])], 1), i("th", { staticClass: "row-modified", attrs: { "aria-sort": t.sortByModified } }, [i(t.NcButton, { attrs: { wide: !0, type: "tertiary" }, on: { click: function(n) {
    return t.toggleSorting("mtime");
  } }, scopedSlots: e._u([{ key: "icon", fn: function() {
    return [t.sortByModified === "ascending" ? i(t.IconSortAscending, { attrs: { size: 20 } }) : t.sortByModified === "descending" ? i(t.IconSortDescending, { attrs: { size: 20 } }) : i("span", { staticStyle: { width: "44px" } })];
  }, proxy: !0 }]) }, [e._v(" " + e._s(t.t("Modified")) + " ")])], 1)])]), i("tbody", [e.loading ? e._l(t.skeletonNumber, function(n) {
    return i(t.LoadingTableRow, { key: n, attrs: { "show-checkbox": e.multiselect } });
  }) : e._l(t.sortedFiles, function(n) {
    return i(t.FileListRow, { key: n.fileid || n.path, attrs: { "allow-pick-directory": e.allowPickDirectory, "show-checkbox": e.multiselect, "can-pick": e.multiselect || e.selectedFiles.length === 0 || e.selectedFiles.includes(n), selected: e.selectedFiles.includes(n), node: n, "crop-image-previews": t.cropImagePreviews }, on: { "update:selected": function(s) {
      return t.onNodeSelected(n);
    }, "enter-directory": t.onChangeDirectory } });
  })], 2)])]);
}, ot = [], ct = /* @__PURE__ */ b(
  lt,
  at,
  ot,
  !1,
  null,
  "d3c94818",
  null,
  null
);
const ut = ct.exports, dt = {
  name: "HomeIcon",
  emits: ["click"],
  props: {
    title: {
      type: String
    },
    fillColor: {
      type: String,
      default: "currentColor"
    },
    size: {
      type: Number,
      default: 24
    }
  }
};
var ft = function() {
  var e = this, i = e._self._c;
  return i("span", e._b({ staticClass: "material-design-icon home-icon", attrs: { "aria-hidden": e.title ? null : !0, "aria-label": e.title, role: "img" }, on: { click: function(t) {
    return e.$emit("click", t);
  } } }, "span", e.$attrs, !1), [i("svg", { staticClass: "material-design-icon__svg", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: "0 0 24 24" } }, [i("path", { attrs: { d: "M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z" } }, [e.title ? i("title", [e._v(e._s(e.title))]) : e._e()])])]);
}, _t = [], pt = /* @__PURE__ */ b(
  dt,
  ft,
  _t,
  !1,
  null,
  null,
  null,
  null
);
const mt = pt.exports, vt = {
  name: "PlusIcon",
  emits: ["click"],
  props: {
    title: {
      type: String
    },
    fillColor: {
      type: String,
      default: "currentColor"
    },
    size: {
      type: Number,
      default: 24
    }
  }
};
var gt = function() {
  var e = this, i = e._self._c;
  return i("span", e._b({ staticClass: "material-design-icon plus-icon", attrs: { "aria-hidden": e.title ? null : !0, "aria-label": e.title, role: "img" }, on: { click: function(t) {
    return e.$emit("click", t);
  } } }, "span", e.$attrs, !1), [i("svg", { staticClass: "material-design-icon__svg", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: "0 0 24 24" } }, [i("path", { attrs: { d: "M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" } }, [e.title ? i("title", [e._v(e._s(e.title))]) : e._e()])])]);
}, ht = [], yt = /* @__PURE__ */ b(
  vt,
  gt,
  ht,
  !1,
  null,
  null,
  null,
  null
);
const wt = yt.exports, bt = /* @__PURE__ */ (0,vue__WEBPACK_IMPORTED_MODULE_11__.defineComponent)({
  __name: "FilePickerBreadcrumbs",
  props: {
    path: null,
    showMenu: { type: Boolean }
  },
  emits: ["update:path", "create-node"],
  setup(r, { emit: e }) {
    const i = r, t = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(""), n = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)();
    function s() {
      const l = t.value.trim(), _ = n.value?.$el?.querySelector("input");
      let a = "";
      return l.length === 0 ? a = (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Folder name cannot be empty.") : l.includes("/") ? a = (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)('"/" is not allowed inside a folder name.') : ["..", "."].includes(l) ? a = (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)('"{name}" is an invalid folder name.', { name: l }) : window.OC.config?.blacklist_files_regex && l.match(window.OC.config?.blacklist_files_regex) && (a = (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)('"{name}" is not an allowed folder name', { name: l })), _ && _.setCustomValidity(a), a === "";
    }
    const o = function() {
      const l = t.value.trim();
      s() && (e("create-node", l), t.value = "");
    }, f = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(
      () => i.path.split("/").filter((l) => l !== "").map((l, _, a) => ({
        name: l,
        path: "/" + a.slice(0, _ + 1).join("/")
      }))
    );
    return { __sfc: !0, props: i, emit: e, newNodeName: t, nameInput: n, validateInput: s, onSubmit: o, pathElements: f, IconFolder: K, IconHome: mt, IconPlus: wt, NcActions: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcActions, NcActionInput: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcActionInput, NcBreadcrumbs: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcBreadcrumbs, NcBreadcrumb: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcBreadcrumb, t: _toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t };
  }
});
var Ct = function() {
  var e = this, i = e._self._c, t = e._self._setupProxy;
  return i(t.NcBreadcrumbs, { staticClass: "file-picker__breadcrumbs", scopedSlots: e._u([{ key: "default", fn: function() {
    return [i(t.NcBreadcrumb, { attrs: { name: t.t("All files"), title: t.t("Home") }, on: { click: function(n) {
      return t.emit("update:path", "/");
    } }, scopedSlots: e._u([{ key: "icon", fn: function() {
      return [i(t.IconHome, { attrs: { size: 20 } })];
    }, proxy: !0 }]) }), e._l(t.pathElements, function(n) {
      return i(t.NcBreadcrumb, { key: n.path, attrs: { name: n.name, title: n.path }, on: { click: function(s) {
        return t.emit("update:path", n.path);
      } } });
    })];
  }, proxy: !0 }, e.showMenu ? { key: "actions", fn: function() {
    return [i(t.NcActions, { attrs: { "aria-label": t.t("Create directory"), "force-menu": !0, "force-name": !0, "menu-name": t.t("New"), type: "secondary" }, on: { close: function(n) {
      t.newNodeName = "";
    } }, scopedSlots: e._u([{ key: "icon", fn: function() {
      return [i(t.IconPlus, { attrs: { size: 20 } })];
    }, proxy: !0 }], null, !1, 2971667417) }, [i(t.NcActionInput, { ref: "nameInput", attrs: { value: t.newNodeName, label: t.t("New folder"), placeholder: t.t("New folder name") }, on: { "update:value": function(n) {
      t.newNodeName = n;
    }, submit: t.onSubmit, input: t.validateInput }, scopedSlots: e._u([{ key: "icon", fn: function() {
      return [i(t.IconFolder, { attrs: { size: 20 } })];
    }, proxy: !0 }], null, !1, 1614167509) })], 1)];
  }, proxy: !0 } : null], null, !0) });
}, kt = [], Ft = /* @__PURE__ */ b(
  bt,
  Ct,
  kt,
  !1,
  null,
  "a25a2652",
  null,
  null
);
const St = Ft.exports, $t = {
  name: "CloseIcon",
  emits: ["click"],
  props: {
    title: {
      type: String
    },
    fillColor: {
      type: String,
      default: "currentColor"
    },
    size: {
      type: Number,
      default: 24
    }
  }
};
var Nt = function() {
  var e = this, i = e._self._c;
  return i("span", e._b({ staticClass: "material-design-icon close-icon", attrs: { "aria-hidden": e.title ? null : !0, "aria-label": e.title, role: "img" }, on: { click: function(t) {
    return e.$emit("click", t);
  } } }, "span", e.$attrs, !1), [i("svg", { staticClass: "material-design-icon__svg", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: "0 0 24 24" } }, [i("path", { attrs: { d: "M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" } }, [e.title ? i("title", [e._v(e._s(e.title))]) : e._e()])])]);
}, xt = [], Bt = /* @__PURE__ */ b(
  $t,
  Nt,
  xt,
  !1,
  null,
  null,
  null,
  null
);
const Pt = Bt.exports, zt = {
  name: "MagnifyIcon",
  emits: ["click"],
  props: {
    title: {
      type: String
    },
    fillColor: {
      type: String,
      default: "currentColor"
    },
    size: {
      type: Number,
      default: 24
    }
  }
};
var Lt = function() {
  var e = this, i = e._self._c;
  return i("span", e._b({ staticClass: "material-design-icon magnify-icon", attrs: { "aria-hidden": e.title ? null : !0, "aria-label": e.title, role: "img" }, on: { click: function(t) {
    return e.$emit("click", t);
  } } }, "span", e.$attrs, !1), [i("svg", { staticClass: "material-design-icon__svg", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: "0 0 24 24" } }, [i("path", { attrs: { d: "M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" } }, [e.title ? i("title", [e._v(e._s(e.title))]) : e._e()])])]);
}, It = [], Vt = /* @__PURE__ */ b(
  zt,
  Lt,
  It,
  !1,
  null,
  null,
  null,
  null
);
const Rt = Vt.exports;
/**
 * @copyright Copyright (c) 2024 Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @author Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @license AGPL-3.0-or-later
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 */
const Dt = (r) => {
  const e = [
    {
      id: "files",
      label: (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("All files"),
      icon: _mdi_js__WEBPACK_IMPORTED_MODULE_13__.mdiFolder
    },
    {
      id: "recent",
      label: (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Recent"),
      icon: _mdi_js__WEBPACK_IMPORTED_MODULE_13__.mdiClock
    },
    {
      id: "favorites",
      label: (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Favorites"),
      icon: _mdi_js__WEBPACK_IMPORTED_MODULE_13__.mdiStar
    }
  ], i = r.value ? e.filter(({ id: t }) => t === "files") : e;
  return {
    allViews: e,
    availableViews: i
  };
}, Ht = /* @__PURE__ */ (0,vue__WEBPACK_IMPORTED_MODULE_11__.defineComponent)({
  __name: "FilePickerNavigation",
  props: {
    currentView: null,
    filterString: null,
    isCollapsed: { type: Boolean },
    disabledNavigation: { type: Boolean }
  },
  emits: ["update:currentView", "update:filterString"],
  setup(r, { emit: e }) {
    const i = r, { availableViews: t } = Dt((0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)((0,_nextcloud_auth__WEBPACK_IMPORTED_MODULE_7__.getCurrentUser)() === null)), n = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => t.filter((o) => o.id === i.currentView)[0] ?? t[0]);
    return { __sfc: !0, props: i, emit: e, availableViews: t, currentViewObject: n, updateFilterValue: (o) => e("update:filterString", o), IconClose: Pt, IconMagnify: Rt, NcButton: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcButton, NcIconSvgWrapper: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcIconSvgWrapper, NcSelect: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcSelect, NcTextField: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcTextField, Fragment: vue_frag__WEBPACK_IMPORTED_MODULE_8__.Fragment, t: _toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t };
  }
});
var Mt = function() {
  var e = this, i = e._self._c, t = e._self._setupProxy;
  return i(t.Fragment, [i(t.NcTextField, { staticClass: "file-picker__filter-input", attrs: { value: e.filterString, label: t.t("Filter file list"), "show-trailing-button": !!e.filterString }, on: { "update:value": t.updateFilterValue, "trailing-button-click": function(n) {
    return t.updateFilterValue("");
  } }, scopedSlots: e._u([{ key: "trailing-button-icon", fn: function() {
    return [i(t.IconClose, { attrs: { size: 16 } })];
  }, proxy: !0 }]) }, [i(t.IconMagnify, { attrs: { size: 16 } })], 1), t.availableViews.length > 1 && !e.disabledNavigation ? [e.isCollapsed ? i(t.NcSelect, { attrs: { "aria-label": t.t("Current view selector"), clearable: !1, searchable: !1, options: t.availableViews, value: t.currentViewObject }, on: { input: (n) => t.emit("update:currentView", n.id) } }) : i("ul", { staticClass: "file-picker__side" }, e._l(t.availableViews, function(n) {
    return i("li", { key: n.id }, [i(t.NcButton, { attrs: { type: e.currentView === n.id ? "primary" : "tertiary", wide: !0 }, on: { click: function(s) {
      return e.$emit("update:currentView", n.id);
    } }, scopedSlots: e._u([{ key: "icon", fn: function() {
      return [i(t.NcIconSvgWrapper, { attrs: { path: n.icon, size: 20 } })];
    }, proxy: !0 }], null, !0) }, [e._v(" " + e._s(n.label) + " ")])], 1);
  }), 0)] : e._e()], 2);
}, At = [], Tt = /* @__PURE__ */ b(
  Ht,
  Mt,
  At,
  !1,
  null,
  "a06474d4",
  null,
  null
);
const Ut = Tt.exports;
/**
 * @copyright Copyright (c) 2023 Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @author Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @license AGPL-3.0-or-later
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
const Et = function(r, e, i) {
  const t = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => i.value ? "/" : _nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.davRootPath), n = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => i.value ? (0,_nextcloud_router__WEBPACK_IMPORTED_MODULE_4__.generateRemoteUrl)("webdav").replace("/remote.php", "/public.php") : _nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.davRemoteURL), s = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => {
    if (i.value) {
      const c = document.getElementById("sharingToken").value, d = btoa(`${c}:null`);
      return (0,_nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.davGetClient)(n.value, {
        Authorization: `Basic ${d}`
      });
    }
    return (0,_nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.davGetClient)();
  }), o = (c) => (0,_nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.davResultToNode)(c, t.value, n.value), f = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)([]), l = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(!0);
  async function _(c) {
    const d = (0,path__WEBPACK_IMPORTED_MODULE_10__.join)(e.value, c);
    await s.value.createDirectory((0,path__WEBPACK_IMPORTED_MODULE_10__.join)(t.value, d));
    const C = await a(d);
    return f.value.push(C), C;
  }
  async function a(c, d = void 0) {
    d = d ?? t.value;
    const { data: C } = await s.value.stat(`${d}${c}`, {
      details: !0
    });
    return o(C);
  }
  async function k() {
    if (l.value = !0, r.value === "favorites")
      f.value = await (0,_nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.getFavoriteNodes)(s.value, e.value, t.value);
    else if (r.value === "recent") {
      const c = Math.round(Date.now() / 1e3) - 1209600, { data: d } = await s.value.search("/", {
        details: !0,
        data: (0,_nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.davGetRecentSearch)(c)
      });
      f.value = d.results.map(o);
    } else {
      const c = await s.value.getDirectoryContents(`${t.value}${e.value}`, {
        details: !0,
        data: (0,_nextcloud_files__WEBPACK_IMPORTED_MODULE_0__.davGetDefaultPropfind)()
      });
      f.value = c.data.map(o), i.value && (f.value = f.value.filter((d) => d.path !== e.value));
    }
    l.value = !1;
  }
  return (0,vue__WEBPACK_IMPORTED_MODULE_11__.watch)([r, e], () => k()), (0,vue__WEBPACK_IMPORTED_MODULE_11__.onMounted)(() => k()), {
    isLoading: l,
    files: f,
    loadFiles: k,
    getFile: a,
    createDirectory: _
  };
};
/**
 * @copyright Copyright (c) 2023 Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @author Ferdinand Thiessen <opensource@fthiessen.de>
 *
 * @license AGPL-3.0-or-later
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
const Ot = function(r) {
  const e = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => r.value.map((t) => t.split("/")));
  return {
    isSupportedMimeType: (t) => {
      const n = t.split("/");
      return e.value.some(
        ([s, o]) => (
          // check mime type matches or is wildcard
          (n[0] === s || s === "*") && (n[1] === o || o === "*")
        )
      );
    }
  };
}, Zt = {
  name: "FilePicker"
}, Wt = /* @__PURE__ */ (0,vue__WEBPACK_IMPORTED_MODULE_11__.defineComponent)({
  ...Zt,
  props: {
    buttons: null,
    name: null,
    allowPickDirectory: { type: Boolean, default: !1 },
    disabledNavigation: { type: Boolean, default: !1 },
    container: { default: "body" },
    filterFn: { default: void 0 },
    mimetypeFilter: { default: () => [] },
    multiselect: { type: Boolean, default: !0 },
    path: { default: void 0 }
  },
  emits: ["close"],
  setup(r, { emit: e }) {
    const i = r, { isPublic: t } = D(), n = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(!0), s = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => (typeof i.buttons == "function" ? i.buttons(a.value, d.value, l.value) : i.buttons).map((w) => ({
      ...w,
      callback: () => {
        o = !0, f(w.callback);
      }
    })));
    let o = !1;
    const f = async (v) => {
      const w = a.value.length === 0 && i.allowPickDirectory ? [await S(d.value)] : a.value;
      v(w), e("close", w), o = !1;
    }, l = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)("files"), _ = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => l.value === "favorites" ? (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Favorites") : l.value === "recent" ? (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Recent") : ""), a = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)([]), k = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(window?.sessionStorage.getItem("NC.FilePicker.LastPath") || "/"), c = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(), d = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)({
      // Only use the path for the files view as favorites and recent only works on the root
      get: () => l.value === "files" ? c.value || i.path || k.value : "/",
      /**
       * Navigate to the new path and save it to the session storage
       *
       * @param path The new path
       */
      set: (v) => {
        i.path === void 0 && window.sessionStorage.setItem("NC.FilePicker.LastPath", v), c.value = v, a.value = [];
      }
    }), C = (0,vue__WEBPACK_IMPORTED_MODULE_11__.ref)(""), { isSupportedMimeType: L } = Ot((0,vue__WEBPACK_IMPORTED_MODULE_11__.toRef)(i, "mimetypeFilter")), { files: N, isLoading: I, loadFiles: x, getFile: S, createDirectory: g } = Et(l, d, t);
    (0,vue__WEBPACK_IMPORTED_MODULE_11__.onMounted)(() => x());
    const { showHiddenFiles: F } = G(), h = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => {
      let v = N.value;
      return F.value || (v = v.filter((w) => !w.basename.startsWith("."))), i.mimetypeFilter.length > 0 && (v = v.filter((w) => w.type === "folder" || w.mime && L(w.mime))), C.value && (v = v.filter((w) => w.basename.toLowerCase().includes(C.value.toLowerCase()))), i.filterFn && (v = v.filter((w) => i.filterFn(w))), v;
    }), m = (0,vue__WEBPACK_IMPORTED_MODULE_11__.computed)(() => l.value === "files" ? (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Upload some content or sync with your devices!") : l.value === "recent" ? (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Files and folders you recently modified will show up here.") : (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Files and folders you mark as favorite will show up here."));
    return { __sfc: !0, props: i, emit: e, isPublic: t, isOpen: n, dialogButtons: s, isHandlingCallback: o, handleButtonClick: f, currentView: l, viewHeadline: _, selectedFiles: a, savedPath: k, navigatedPath: c, currentPath: d, filterString: C, isSupportedMimeType: L, files: N, isLoading: I, loadFiles: x, getFile: S, createDirectory: g, showHiddenFiles: F, filteredFiles: h, noFilesDescription: m, onCreateFolder: async (v) => {
      try {
        await g(v), (0,_nextcloud_event_bus__WEBPACK_IMPORTED_MODULE_9__.emit)("files:node:created", N.value.filter((w) => w.basename === v)[0]);
      } catch (w) {
        console.warn("Could not create new folder", { name: v, error: w }), (0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.k)((0,_toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t)("Could not create the new folder"));
      }
    }, handleClose: (v) => {
      !v && !o && e("close");
    }, IconFile: W, FileList: ut, FilePickerBreadcrumbs: St, FilePickerNavigation: Ut, NcDialog: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcDialog, NcEmptyContent: _nextcloud_vue__WEBPACK_IMPORTED_MODULE_2__.NcEmptyContent, t: _toast_WB_IZBJw_mjs__WEBPACK_IMPORTED_MODULE_6__.t };
  }
});
var Gt = function() {
  var e = this, i = e._self._c, t = e._self._setupProxy;
  return i(t.NcDialog, { attrs: { container: e.container, buttons: t.dialogButtons, name: e.name, size: "large", "content-classes": "file-picker__content", "dialog-classes": "file-picker", "navigation-classes": "file-picker__navigation", open: t.isOpen }, on: { "update:open": [function(n) {
    t.isOpen = n;
  }, t.handleClose] }, scopedSlots: e._u([{ key: "navigation", fn: function({ isCollapsed: n }) {
    return [i(t.FilePickerNavigation, { attrs: { "is-collapsed": n, "current-view": t.currentView, "filter-string": t.filterString, "disabled-navigation": e.disabledNavigation }, on: { "update:currentView": function(s) {
      t.currentView = s;
    }, "update:current-view": function(s) {
      t.currentView = s;
    }, "update:filterString": function(s) {
      t.filterString = s;
    }, "update:filter-string": function(s) {
      t.filterString = s;
    } } })];
  } }]) }, [i("div", { staticClass: "file-picker__main" }, [t.currentView === "files" ? i(t.FilePickerBreadcrumbs, { attrs: { path: t.currentPath, "show-menu": e.allowPickDirectory }, on: { "update:path": function(n) {
    t.currentPath = n;
  }, "create-node": t.onCreateFolder } }) : i("div", { staticClass: "file-picker__view" }, [i("h3", [e._v(e._s(t.viewHeadline))])]), t.isLoading || t.filteredFiles.length > 0 ? i(t.FileList, { attrs: { "allow-pick-directory": e.allowPickDirectory, "current-view": t.currentView, files: t.filteredFiles, multiselect: e.multiselect, loading: t.isLoading, path: t.currentPath, "selected-files": t.selectedFiles, name: t.viewHeadline }, on: { "update:path": [function(n) {
    t.currentPath = n;
  }, function(n) {
    t.currentView = "files";
  }], "update:selectedFiles": function(n) {
    t.selectedFiles = n;
  }, "update:selected-files": function(n) {
    t.selectedFiles = n;
  } } }) : t.filterString ? i(t.NcEmptyContent, { attrs: { name: t.t("No matching files"), description: t.t("No files matching your filter were found.") }, scopedSlots: e._u([{ key: "icon", fn: function() {
    return [i(t.IconFile)];
  }, proxy: !0 }]) }) : i(t.NcEmptyContent, { attrs: { name: t.t("No files in here"), description: t.noFilesDescription }, scopedSlots: e._u([{ key: "icon", fn: function() {
    return [i(t.IconFile)];
  }, proxy: !0 }]) })], 1)]);
}, jt = [], Kt = /* @__PURE__ */ b(
  Wt,
  Gt,
  jt,
  !1,
  null,
  "9def3ca4",
  null,
  null
);
const ui = Kt.exports;



/***/ })

}]);
//# sourceMappingURL=data_image_svg_xml_3csvg_20xmlns_27http_www_w3_org_2000_svg_27_20width_2724_27_20height_2724_-28884d-data_image_svg_xml_3csvg_20xmlns_27http_www_w3_org_2000_svg_27_20width_2724_27_20height_2724_-28884d.js.map?v=5e4ceb7fd9d03ea20c8b